<div class="grid">
    <div class="col-11">
        <h2>{{ collService.selectedColl.display_name }}</h2>
        <p> {{ collService.selectedColl.collection_description }} </p>
    </div>
    <div class="col-1">
        <p-button (onClick)="delCollection()" icon="pi pi-trash" [disabled]="!activated"></p-button>
    </div>
</div>
<div>
    <p-accordion [multiple]="false">
        <p-accordionTab *ngFor="let chapter of chapterService.collChapters, let i=index"
                        class="m-1" [header]="chapter.name.toString()" (selectedChange)="openChapter(chapter.id)">
            <p-card header="Tabs im Kapitel {{ chapter.name.toString() }}">
                <p-button (onClick)="openNewTabPanel(i)" label="Neuer Tab" icon="pi pi-plus"></p-button>
                <p-tabView  [(activeIndex)]="activeIndex" (onChange)="openTab(activeIndex)">
                    <p-tabPanel *ngFor="let exTab of tabService.tabs, let itab=index"
                    [header]="exTab.exercise_tab_name">
                    <div class="flex align-items-center justify-content-between">
                        <h3>{{ exTab.exercise_tab_name }}</h3>
                        <p-button class="ml-4" (onClick)="delTab(exTab.id)" icon="pi pi-times"
                                 label="Tab löschen" severity="danger" size="small">
                        </p-button>
                    </div>
                        <div>
                            <p><em>[Beschreibung des Tabs:]</em> {{ exTab.exercise_description }}</p>
                            <p-button (onClick)="openDialogUpdateDescription()" label="Beschreibung bearbeiten"></p-button>
                        </div>
                        <p-divider></p-divider>
                        <div>
                            <!--"{{ HOST }}/serve_media/{{ collService.selectedColl.user_code }}/{{ exTab.img_url }}"-->
                            <h5>Bild/Partitur</h5>
                            <img *ngIf="tabService.selectedTab.img_url != ''"
                                [src]="imgURL"
                                alt="{{ exTab.img_url }}" width="100%"/>
                            <div *ngIf="tabService.selectedTab.img_url === ''">
                                Kein Bild hinterlegt.
                            </div>
                            <div class="flex justify-content-left">
                                <p-fileUpload #imgUpload class="m-2" mode="basic" chooseLabel="Bild auswählen"
                                                name="file" [url]="tabService.selectedUploadURLImg"
                                                accept="image/*"
                                                [auto]="true"
                                                (onUpload)="onUpload($event)">
                                </p-fileUpload>
                                <p-button class="mt-2 mr-2" (onClick)="clearMedia('img')" icon="pi pi-times" severity="danger"
                                            [disabled]="tabService.selectedTab.img_url === ''"></p-button>
                            </div>
                        </div>
                        <p-divider></p-divider>
                        <div>
                            <h5>Audio</h5>
                            <div class="flex">
                                <div class="mr-2 mt-2" *ngIf="tabService.selectedTab.audio_url != ''">
                                    <p-button [icon]="player_icon" [rounded]="true" [text]="true"
                                            [raised]="true" (onClick)="playPauseAudio()">
                                    </p-button>
                                </div>
                                <div *ngIf="tabService.selectedTab.audio_url === ''">
                                    Keine Audiodatei hinterlegt.
                                </div>
                                <!--{{ HOST }}/serve_media/{{ collService.selectedColl.user_code }}/{{ exTab.audio_url }}-->
                                <div class="flex justify-content-left">
                                    <p-fileUpload #audioUpload class="m-2" mode="basic" chooseLabel="Audio auswählen"
                                                name="file" [url]="tabService.selectedUploadURLAudio"
                                                accept="audio/mpeg" [auto]="true"
                                                (onUpload)="onUpload($event)">
                                </p-fileUpload>
                                <p-button class="m-2" (onClick)="clearMedia('audio')" icon="pi pi-times" severity="danger"
                                            [disabled]="tabService.selectedTab.audio_url === ''"></p-button>
                                </div>
                            </div>
                        </div>
                    </p-tabPanel>
                </p-tabView>
                <ng-template pTemplate="footer">
                    <p-button severity="danger" (onClick)="delChapter()"
                                label="Chapter löschen" icon="pi pi-trash" [disabled]="!activated"></p-button>
                </ng-template>
            </p-card>
        </p-accordionTab>
    </p-accordion>
    <div class="m-2">
        <p-button (onClick)="openDialogNewChapter()" icon="pi pi-plus" [hidden]="!activated"></p-button>
    </div>
</div>